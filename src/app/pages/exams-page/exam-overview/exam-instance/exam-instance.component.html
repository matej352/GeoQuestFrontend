<app-header></app-header>
<div class="exam-instance">
  <div class="exam-instance-container">
    <div class="back-container">
      <fa-icon
        [icon]="back"
        class="fa-2x back"
        title="Nazad"
        (click)="navigateBack()"
      ></fa-icon>
    </div>
    <ng-container *ngIf="loading; else loaded">
      <div>Loading</div>
    </ng-container>
    <ng-template #loaded>
      <div class="general-info">
        <div class="test-name">
          <h1>{{ testInstance.testName + " - " + testInstance.student }}</h1>
          <ng-container *ngIf="testInstance.allChecked; else notChecked">
            <div class="test-status checked">Ispravljeno</div>
          </ng-container>
          <ng-template #notChecked>
            <div class="test-status notChecked">Djelomično ispravljeno</div>
          </ng-template>
        </div>
        <div class="info">
          <div class="row">
            <div class="group">
              <p class="name">Ostvaren broj bodova</p>
              <p class="value">
                {{
                  testInstance.studentTotalPoints +
                    "/" +
                    testInstance.testTotalPoints
                }}
              </p>
            </div>
          </div>
          <div class="row">
            <div class="group">
              <p class="name">Postotak riješenosti</p>
              <p class="value">{{ testInstance.successPercentage }}</p>
            </div>
          </div>
        </div>
      </div>

      <div class="tasks-container">
        <app-task-result-card
          [currentUser]="currentUser$ | async"
          *ngFor="let task of testInstance.testTasks; let index = index"
          [task]="task"
          [class]="'task' + task.id"
          [index]="index"
        ></app-task-result-card>
      </div>
    </ng-template>
  </div>
</div>
