<app-header></app-header>

<div class="exams-page">
  <div class="exams-page-container">
    <div class="board">
      <ng-container *ngIf="tests$ | async as tests">
        <table *ngIf="tests.length !== 0; else noTests">
          <thead>
            <tr>
              <th>Naslov</th>
              <th>Opis</th>
              <th>Predmet</th>
              <th>Trajanje</th>
              <th>Napredak</th>
              <th>Status</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let test of tests">
              <td class="username" [routerLink]="['exam', test.id]">
                <p>{{ test.name }}</p>
              </td>
              <td>
                <p>{{ test.description ? test.description : "-" }}</p>
              </td>
              <td>
                <p>{{ test.subject }}</p>
              </td>
              <td>
                <p>{{ test.duration }}</p>
              </td>
              <td>
                <p>
                  {{
                    (test.finishedByStudentInstanceCount / test.instanceCount) *
                      100 +
                      "%"
                  }}
                </p>
                <app-tooltip
                  [message]="
                    'Ispit je riješilo ' +
                    test.finishedByStudentInstanceCount +
                    '/' +
                    test.instanceCount +
                    ' učenika'
                  "
                ></app-tooltip>
              </td>
              <td>
                <ng-container *ngIf="test.active; else testClosed">
                  <div class="test-status pending">U tijeku</div>
                </ng-container>
                <ng-template #testClosed>
                  <div class="test-status closed">Zatvoren</div>
                </ng-template>
              </td>
              <td>
                <ng-container *ngIf="test.active">
                  <span (click)="closeTest(test.id)" class="button-close"
                    >Zatvori</span
                  >
                  <app-tooltip
                    message="Učenici više neće moći pokrenuti ispit"
                  ></app-tooltip
                ></ng-container>
              </td>
            </tr>
          </tbody>
        </table>
        <ng-template #noTests>
          <div class="no-students">Nemate ispite</div>
        </ng-template>
      </ng-container>
    </div>
  </div>
</div>
