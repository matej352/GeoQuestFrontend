<main>
  <div class="configuration-container">
    <ng-container [ngSwitch]="task.type">
      <ng-container *ngSwitchCase="TaskType.MarkPoint">
        <div class="left">
          <app-mark-point-map
            [mapType]="getMapType(task.mapType)"
            [mapId]="task.id!.toString()"
            [answer]="task.studentAnswer!"
            [correctAnswer]="task.correctAnswer!"
            [mode]="mode"
            [config]="{
              mapCenter: task.mapCenter,
              mapZoomLevel: task.mapZoomLevel
            }"
            [currentUserRole]="currentUser!.role"
          ></app-mark-point-map>
        </div>
        <div class="right">
          <div class="header-container">
            <div class="task-index">{{ index + 1 }}. zadatak</div>
            <ng-container *ngIf="task.isCorrect; else incorrect">
              <div class="correctness true">
                Točno <fa-icon [icon]="correctTrue"></fa-icon>
              </div>
            </ng-container>
            <ng-template #incorrect>
              <div class="correctness false">
                {{ task.studentAnswer ? "Netočno" : "Neodgovoreno" }}
                <fa-icon [icon]="correctFalse"></fa-icon>
              </div>
            </ng-template>
          </div>

          <div class="form-container">
            <div class="form-group">
              <label for="question-type"> Tip zadatka </label>
              <div class="question-type">Označi točkom na karti</div>
            </div>
            <div class="form-group-column">
              <label for="question"> Tekst zadatka </label>
              <div class="question" [innerHTML]="task.question"></div>
            </div>
          </div>
          <div class="legend">
            <div class="item">
              <img src="assets/marker-correct-icon.png" />
              <span> - Točan odgovor</span>
            </div>
            <div class="item">
              <img src="assets/marker-icon.png" /><span>
                -
                {{
                  currentUser!.role === 0 ? " Učenikov odgovor" : " Vaš odgovor"
                }}
              </span>
            </div>
          </div>
        </div>
      </ng-container>
      <ng-container *ngSwitchCase="TaskType.SelectPolygon">
        <div class="left">
          <app-select-polygon-map
            [mapType]="getMapType(task.mapType)"
            [mapId]="task.id!.toString()"
            [answers]="task.options!.optionAnswers"
            [answer]="+task.studentAnswer!"
            [correctAnswer]="+task.correctAnswer!"
            [mode]="mode"
            [config]="{
              mapCenter: task.mapCenter,
              mapZoomLevel: task.mapZoomLevel
            }"
            [currentUserRole]="currentUser!.role"
          ></app-select-polygon-map>
        </div>
        <div class="right">
          <div class="header-container">
            <div class="task-index">{{ index + 1 }}. zadatak</div>
            <ng-container *ngIf="task.isCorrect; else incorrect">
              <div class="correctness true">
                Točno <fa-icon [icon]="correctTrue"></fa-icon>
              </div>
            </ng-container>
            <ng-template #incorrect>
              <div class="correctness false">
                {{ task.studentAnswer ? "Netočno" : "Neodgovoreno" }}
                <fa-icon [icon]="correctFalse"></fa-icon>
              </div>
            </ng-template>
          </div>

          <div class="form-container">
            <div class="form-group">
              <label for="question-type"> Tip zadatka </label>
              <div class="question-type">Odaberi točan odgovor na karti</div>
            </div>
            <div class="form-group-column">
              <label for="question"> Tekst zadatka </label>
              <div class="question" [innerHTML]="task.question"></div>
            </div>
          </div>
          <div class="legend">
            <div class="item">
              <div class="square green"></div>
              <span>
                -{{
                  task.isCorrect
                    ? currentUser!.role === 0
                      ? " Učenikov točan odgovor"
                      : " Vaš točan odgovor"
                    : " Točan odgovor"
                }}</span
              >
            </div>
            <div class="item" *ngIf="!task.isCorrect">
              <div class="square red"></div>
              <span>
                -
                {{
                  currentUser!.role === 0 ? " Učenikov odgovor" : " Vaš odgovor"
                }}
              </span>
            </div>
          </div>
        </div>
      </ng-container>
      <ng-container *ngSwitchCase="TaskType.SelectPoint">
        <div class="left">
          <app-select-point-map
            [mapType]="getMapType(task.mapType)"
            [mapId]="task.id!.toString()"
            [answers]="task.options!.optionAnswers"
            [answer]="+task.studentAnswer!"
            [correctAnswer]="+task.correctAnswer!"
            [mode]="mode"
            [config]="{
              mapCenter: task.mapCenter,
              mapZoomLevel: task.mapZoomLevel
            }"
            [currentUserRole]="currentUser!.role"
          ></app-select-point-map>
        </div>
        <div class="right">
          <div class="header-container">
            <div class="task-index">{{ index + 1 }}. zadatak</div>
            <ng-container *ngIf="task.isCorrect; else incorrect">
              <div class="correctness true">
                Točno <fa-icon [icon]="correctTrue"></fa-icon>
              </div>
            </ng-container>
            <ng-template #incorrect>
              <div class="correctness false">
                {{ task.studentAnswer ? "Netočno" : "Neodgovoreno" }}
                <fa-icon [icon]="correctFalse"></fa-icon>
              </div>
            </ng-template>
          </div>

          <div class="form-container">
            <div class="form-group">
              <label for="question-type"> Tip zadatka </label>
              <div class="question-type">Odaberi točan odgovor na karti</div>
            </div>
            <div class="form-group-column">
              <label for="question"> Tekst zadatka </label>
              <div class="question" [innerHTML]="task.question"></div>
            </div>
          </div>
          <div class="legend">
            <div class="item">
              <img src="assets/marker-correct-icon.png" />
              <span>
                -
                {{
                  task.isCorrect
                    ? currentUser!.role === 0
                      ? " Učenikov točan odgovor"
                      : " Vaš točan odgovor"
                    : " Točan odgovor"
                }}
              </span>
            </div>
            <div class="item" *ngIf="!task.isCorrect">
              <img src="assets/marker-icon.png" /><span>
                -
                {{
                  currentUser!.role === 0 ? " Učenikov odgovor" : " Vaš odgovor"
                }}
              </span>
            </div>
          </div>
        </div>
      </ng-container>
      <ng-container *ngSwitchCase="TaskType.MarkPolygon">
        <div class="left">
          <app-mark-polygon-map
            [mapType]="getMapType(task.mapType)"
            [mapId]="task.id!.toString()"
            [answer]="task.studentAnswer!"
            [correctAnswer]="task.correctAnswer!"
            [mode]="mode"
            [config]="{
              mapCenter: task.mapCenter,
              mapZoomLevel: task.mapZoomLevel
            }"
            [currentUserRole]="currentUser!.role"
          ></app-mark-polygon-map>
        </div>
        <div class="right">
          <div class="header-container">
            <div class="task-index">{{ index + 1 }}. zadatak</div>
            <ng-container *ngIf="task.isCorrect; else incorrect">
              <div class="correctness true">
                Točno <fa-icon [icon]="correctTrue"></fa-icon>
              </div>
            </ng-container>
            <ng-template #incorrect>
              <div class="correctness false">
                {{ task.studentAnswer ? "Netočno" : "Neodgovoreno" }}
                <fa-icon [icon]="correctFalse"></fa-icon>
              </div>
            </ng-template>
          </div>

          <div class="form-container">
            <div class="form-group">
              <label for="question-type"> Tip zadatka </label>
              <div class="question-type">Označi na karti</div>
            </div>
            <div class="form-group-column">
              <label for="question"> Tekst zadatka </label>
              <div class="question" [innerHTML]="task.question"></div>
            </div>
          </div>
          <div class="legend">
            <div class="item">
              <div class="square green"></div>
              <span> - Točan odgovor</span>
            </div>
            <div class="item">
              <div class="square blue"></div>
              <span>
                -
                {{
                  currentUser!.role === 0 ? "Učenikov odgovor" : "Vaš odgovor"
                }}
              </span>
            </div>
          </div>
        </div>
      </ng-container>
      <ng-container *ngSwitchCase="TaskType.NonMap">
        <div class="left">
          <app-non-map-map
            [mapType]="getMapType(task.mapType)"
            [mapId]="task.id!.toString()"
            [answer]="task.studentAnswer!"
            [nonMapPoint]="task.nonMapPoint!"
            [mode]="mode"
            [config]="{
              mapCenter: task.mapCenter,
              mapZoomLevel: task.mapZoomLevel
            }"
          ></app-non-map-map>
        </div>
        <div class="right">
          <div class="header-container">
            <div class="task-index">{{ index + 1 }}. zadatak</div>
            <ng-container *ngIf="task.checked; else pending">
              <ng-container *ngIf="task.isCorrect; else incorrect">
                <div class="correctness true">
                  Točno <fa-icon [icon]="correctTrue"></fa-icon>
                </div>
              </ng-container>
              <ng-template #incorrect>
                <div class="correctness false">
                  {{ task.studentAnswer ? "Netočno" : "Neodgovoreno" }}
                  <fa-icon [icon]="correctFalse"></fa-icon>
                </div>
              </ng-template>
            </ng-container>
            <ng-template #pending>
              <div class="correctness pending">
                Neocjenjeno <fa-icon [icon]="correctPending"></fa-icon>
              </div>
            </ng-template>
          </div>

          <div class="form-container">
            <div class="form-group">
              <label for="question-type"> Tip zadatka </label>
              <div class="question-type">Obično pitanje</div>
            </div>
            <div class="form-group-column">
              <label for="question"> Tekst zadatka </label>
              <div class="question" [innerHTML]="task.question"></div>
            </div>
          </div>
          <div
            class="non-map-actions-container"
            *ngIf="currentUser?.role === 0 && task.studentAnswer"
          >
            <button
              class="correctness-buttons"
              [ngClass]="{ disabled: task.checked && task.isCorrect }"
              [disabled]="task.checked && task.isCorrect"
              (click)="gradeTask(true)"
            >
              Točno
            </button>
            <button
              class="correctness-buttons"
              [disabled]="task.checked && !task.isCorrect"
              [ngClass]="{ disabled: task.checked && !task.isCorrect }"
              (click)="gradeTask(false)"
            >
              Netočno
            </button>
          </div>
        </div>
      </ng-container>
    </ng-container>
  </div>
</main>
